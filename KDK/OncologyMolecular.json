{
  "$id": "https://www.bfarm.de/schemas/genomde/OncologyMolecular",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Oncology Molecular Report",
  "description": "Schema for molecular report in oncology, including various variant types.",
  "type": "object",
  "properties": {
    "SmallVariant": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/SmallVariant"
      }
    },
    "CopyNumberVariant": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/CopyNumberVariant"
      }
    },
    "StructuralVariant": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/StructuralVariant"
      }
    },
    "ExpressionVariant": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/ExpressionVariant"
      }
    }
  },
  "$defs": {
    "Common": {
      "properties": {
        "genomicSource": {
          "type": "string",
          "enum": [
            "somatic",
            "germline"
          ],
          "description": "Source of the genomic material."
        },
        "gene": {
          "description": "Gene symbol (HGNC) and HGNC ID. e.g., HGNC:1100",
          "allOf": [
            {
              "$ref": "https://www.bfarm.de/schemas/genomde/data-types/Coding#"
            },
            {
              "required": [
                "code",
                "display"
              ]
            }
          ]
        },
        "localization": {
          "type": "string",
          "description": "Localization of molecular alteration.",
          "enum": [
            "coding",
            "inRegulatoryElements",
            "notInCodingAndNotInRegulatoryElements"
          ]
        },
        "identifier": {
          "type": "string",
          "description": "Unique identifier for the variant."
        }
      }
    },
    "SmallVariant": {
      "type": "object",
      "properties": {
        "identifier": {
          "$ref": "#/$defs/Common/properties/identifier"
        },
        "genomicSource": {
          "$ref": "#/$defs/Common/properties/genomicSource"
        },
        "gene": {
          "$ref": "#/$defs/Common/properties/gene"
        },
        "transcriptId": {
          "type": "string",
          "description": "Transcript ID (Ensembl/RefSeq) with version. e.g., ENST00000644379.2"
        },
        "dnaChange": {
          "type": "string",
          "description": "DNA level alteration (HGVSc)."
        },
        "proteinChange": {
          "type": "string",
          "description": "Protein level alteration (HGVSp)."
        },
        "variantType": {
          "type": "array",
          "items": {
            "type": "string",
            "description": "Alteration type from Sequence Ontology."
          }
        },
        "localization": {
          "$ref": "#/$defs/Common/properties/localization"
        },
        "LOH": {
          "type": "boolean",
          "description": "Loss of heterozygosity."
        }
      },
      "required": [
        "identifier",
        "genomicSource",
        "gene",
        "transcriptId",
        "dnaChange",
        "variantType",
        "localization",
        "LOH"
      ]
    },
    "CopyNumberVariant": {
      "type": "object",
      "description": "Copy number changes (affecting a gene).",
      "properties": {
        "identifier": {
          "$ref": "#/$defs/Common/properties/identifier"
        },
        "genomicSource": {
          "$ref": "#/$defs/Common/properties/genomicSource"
        },
        "cnvType": {
          "type": "string",
          "enum": [
            "completeCopyNumberLoss",
            "incompleteCopyNumberLoss",
            "amplification"
          ],
          "description": "Type of copy number alteration."
        },
        "gene": {
          "$ref": "#/$defs/Common/properties/gene"
        },
        "chromosome": {
          "type": "string",
          "enum": [
            "chr1",
            "chr2",
            "chr3",
            "chr4",
            "chr5",
            "chr6",
            "chr7",
            "chr8",
            "chr9",
            "chr10",
            "chr11",
            "chr12",
            "chr13",
            "chr14",
            "chr15",
            "chr16",
            "chr17",
            "chr18",
            "chr19",
            "chr20",
            "chr21",
            "chr22",
            "chrX",
            "chrY"
          ]
        },
        "endPosition": {
          "type": "integer",
          "description": "End position on the chromosome (HG38-Position)."
        },
        "startPosition": {
          "type": "integer",
          "description": "Start position on the chromosome (HG38-Position)."
        },
        "copyNumber": {
          "type": "integer",
          "description": "Number of copies."
        },
        "localization": {
          "$ref": "#/$defs/Common/properties/localization"
        }
      },
      "required": [
        "identifier",
        "genomicSource",
        "copyNumber",
        "localization"
      ]
    },
    "StructuralVariant": {
      "type": "object",
      "description": "Structural variants (except in-frame fusions of two coding genes).",
      "properties": {
        "identifier": {
          "$ref": "#/$defs/Common/properties/identifier"
        },
        "genomicSource": {
          "$ref": "#/$defs/Common/properties/genomicSource"
        },
        "gene": {
          "$ref": "#/$defs/Common/properties/gene"
        },
        "geneC": {
          "$ref": "#/$defs/Common/properties/gene"
        },
        "structureType": {
          "type": "string",
          "enum": [
            "translocationWithNonCodingRegion",
            "inversion",
            "deletionOfGeneSegments",
            "duplicationOfGeneSegments"
          ],
          "description": "Type of structural variant."
        },
        "description": {
          "type": "string",
          "description": "Description of the structural variant (HGVS/ISCN)."
        },
        "sequenceType": {
          "type": "string",
          "enum": [
            "DNA",
            "RNA"
          ]
        },
        "localization": {
          "$ref": "#/$defs/Common/properties/localization"
        }
      },
      "required": [
        "identifier",
        "genomicSource",
        "gene",
        "geneC",
        "structureType",
        "sequenceType",
        "localization"
      ]
    },
    "ExpressionVariant": {
      "type": "object",
      "description": "Expression level of mRNA.",
      "properties": {
        "identifier": {
          "$ref": "#/$defs/Common/properties/identifier"
        },
        "gene": {
          "$ref": "#/$defs/Common/properties/gene"
        },
        "expressionValue": {
          "type": "string",
          "enum": [
            "normalExpression",
            "highExpression",
            "lowExpression"
          ],
          "description": "Expression level of mRNA."
        },
        "reference": {
          "type": "string",
          "description": "e.g. reference cohort of 400 patients"
        },
        "TMB": {
          "type": "number",
          "description": "Tumor mutational burden. mut/MB"
        },
        "HRDhigh": {
          "type": "boolean",
          "description": "High homologous recombination deficiency."
        },
        "LSThigh": {
          "type": "boolean",
          "description": "High large-scale transitions."
        },
        "TAIhigh": {
          "type": "boolean",
          "description": "High telomeric allelic imbalance."
        },
        "SBSversion": {
          "type": "boolean",
          "description": "SBS Signatures Version"
        },
        "SBSsignatures": {
          "type": "string",
          "description": "SBS Signature. e.g. SBS 6"
        },
        "SBSsignaturePresent": {
          "type": "boolean",
          "description": "SBS Signature present."
        },
        "localization": {
          "$ref": "#/$defs/Common/properties/localization"
        }
      },
      "required": [
        "identifier",
        "gene",
        "expressionValue",
        "reference",
        "localization"
      ]
    },
    "Variant": {
      "anyOf": [
        { "$ref": "#/$defs/SmallVariant" },
        { "$ref": "#/$defs/CopyNumberVariant" },
        { "$ref": "#/$defs/StructuralVariant" },
        { "$ref": "#/$defs/ExpressionVariant" }
      ]
    }
  }
}